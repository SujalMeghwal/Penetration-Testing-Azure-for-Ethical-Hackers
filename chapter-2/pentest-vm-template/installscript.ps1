param (
    $UserName
)

# Enable required features
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All -NoRestart
Enable-WindowsOptionalFeature -Online -FeatureName Containers -All -NoRestart

# Install Chocolatey
Set-ExecutionPolicy Bypass -Scope Process -Force
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))

# Install common tools
choco install git zip unzip vscode azure-cli httpie 7zip.install googlechrome setdefaultbrowser win-no-annoy microsoftazurestorageexplorer -y

# Set Chrome as default
SetDefaultBrowser.exe HKLM "Google Chrome"

# Install Docker Engine (supported on Windows Server)
Install-PackageProvider -Name NuGet -Force
Install-Module -Name DockerMsftProvider -Repository PSGallery -Force
Install-Package -Name docker -ProviderName DockerMsftProvider -Force

# Optional: enable WinRM
Enable-PSRemoting -Force

# Restart to fully enable hyper-v, containers, docker engine
Restart-Computer -Force
